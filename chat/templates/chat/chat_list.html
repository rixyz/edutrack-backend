{% extends 'chat/base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white shadow-md rounded-lg overflow-hidden">
    <div class="bg-blue-500 text-white p-4">
        <h2 class="text-xl font-semibold">Your Chats ({{ request.user.id}})</h2>
    </div>

    {% if chat_details %}
        <ul class="divide-y divide-gray-200">
            {% for chat in chat_details %}
                <li class="hover:bg-gray-50 transition duration-200">
                    <a href="{% url 'chat_room' receiver_id=chat.user.id %}"
                       class="block p-4 flex items-center justify-between">
                        <div class="flex items-center w-full">
                            <div class="w-10 h-10 bg-blue-200 rounded-full flex items-center justify-center mr-4">
                                {{ chat.user.first_name|first|upper }}
                            </div>
                            <div class="flex-grow">
                                <div class="flex justify-between items-center">
                                    <span class="font-medium">{{ chat.user.first_name }}</span>
                                    <span class="text-xs text-gray-500">
                                        {{ chat.last_message_time|date:"M d, H:i" }}
                                    </span>
                                </div>
                                <p class="text-sm text-gray-500 truncate max-w-[300px]">
                                    {{ chat.last_message }}
                                </p>
                            </div>
                            <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </a>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <div class="p-4 text-center text-gray-500">
            No chat history found. Start a new conversation!
        </div>
    {% endif %}
</div>
{% endblock %}
